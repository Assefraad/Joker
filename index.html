<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>موقعي</title>
</head>
<body>
    <h1>برنامج لحساب نقاط الورق51</h1>
    <h2>عاصف رعد</h2>
</body>
</html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>برنامج حساب نقاط الورق51</title>
<style>
  body { font-family: Tahoma, Arial, sans-serif; direction: rtl; padding: 16px; background: #f5f7fa; }
  table { border-collapse: collapse; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
  td, th { border: 1px solid #cfcfcf; padding: 6px 8px; min-width: 100px; text-align: center; }
  input.cell { width: 100%; box-sizing: border-box; border: none; outline: none; padding:6px; text-align:center; background: transparent; }
  input.cell[readonly] { background:#efefef; color:#111; }
  .row2 { background: #e6ffe6; } /* صف 2 مظلل بالأخضر الفاتح */
  .positive { background: #e6ffe6 !important; }
  .negative { background: #ffcccc !important; }
  .bold { font-weight: 700; }
</style>
</head>
<body>
<td>تكتب فقط النقاط للفرق الخاسر، ويترك حقل الفريق الفائز فارغ بدون اي كتابة</td>
<table id="sheet">
<tr class=""><td><input id="A1" class="cell" readonly value="الجولة" /></td><td><input id="B1" class="cell" readonly value="الاسم الأول" /></td><td><input id="C1" class="cell" readonly value="الاسم الثاني" /></td></tr>
<tr class="row2"><td><input id="A2" class="cell" readonly value="#" /></td><td><input id="B2" class="cell bold" value="" /></td><td><input id="C2" class="cell bold" value="" /></td></tr>
<tr class=""><td><input id="A3" class="cell" readonly value="1" /></td><td><input id="B3" class="cell" value="" /></td><td><input id="C3" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A4" class="cell" readonly value="2" /></td><td><input id="B4" class="cell" value="" /></td><td><input id="C4" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A5" class="cell" readonly value="3" /></td><td><input id="B5" class="cell" value="" /></td><td><input id="C5" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A6" class="cell" readonly value="4" /></td><td><input id="B6" class="cell" value="" /></td><td><input id="C6" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A7" class="cell" readonly value="5" /></td><td><input id="B7" class="cell" value="" /></td><td><input id="C7" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A8" class="cell" readonly value="6" /></td><td><input id="B8" class="cell" value="" /></td><td><input id="C8" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A9" class="cell" readonly value="7" /></td><td><input id="B9" class="cell" value="" /></td><td><input id="C9" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A10" class="cell" readonly value="8" /></td><td><input id="B10" class="cell" value="" /></td><td><input id="C10" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A11" class="cell" readonly value="9" /></td><td><input id="B11" class="cell" value="" /></td><td><input id="C11" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A12" class="cell" readonly value="10" /></td><td><input id="B12" class="cell" value="" /></td><td><input id="C12" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A13" class="cell" readonly value="11" /></td><td><input id="B13" class="cell" value="" /></td><td><input id="C13" class="cell" value="" /></td></tr>
<tr class=""><td><input id="A14" class="cell bold" readonly value="المجموع" /></td><td><input id="B14" class="cell bold" readonly value="" /></td><td><input id="C14" class="cell bold" readonly value="" /></td></tr>
<tr class=""><td><input id="A15" class="cell bold" readonly value="الفرق" /></td><td><input id="B15" class="cell bold" readonly value="" /></td><td><input id="C15" class="cell bold" readonly value="" /></td></tr>

</table>
<script>
function toNumber(v){
  if(v===null||v===undefined) return NaN;
  var s=String(v).trim();
  if(s==='') return NaN;
  var n=Number(s);
  return isNaN(n)?NaN:n;
}
function recalc(){
  var B=[],C=[];
  for(var r=3;r<=13;r++){ 
    var b=document.getElementById('B'+r);
    var c=document.getElementById('C'+r);
    B.push(b?b.value:'');
    C.push(c?c.value:'');
  }
  var sumB=0; for(var i=0;i<B.length;i++){var n=toNumber(B[i]);if(!isNaN(n))sumB+=n;}
  var penaltyB=0; for(var i=0;i<B.length;i++){var isBlankB=(String(B[i]).trim()==='');var nC=toNumber(C[i]);if(isBlankB&&!isNaN(nC))penaltyB+=25;}
  var B14=sumB-penaltyB;
  var sumC=0; for(var i=0;i<C.length;i++){var n=toNumber(C[i]);if(!isNaN(n))sumC+=n;}
  var penaltyC=0; for(var i=0;i<C.length;i++){var isBlankC=(String(C[i]).trim()==='');var nB=toNumber(B[i]);if(isBlankC&&!isNaN(nB))penaltyC+=25;}
  var C14=sumC-penaltyC;
  if(document.getElementById('B14')) document.getElementById('B14').value=B14;
  if(document.getElementById('C14')) document.getElementById('C14').value=C14;
  var b15=(C14-B14); var c15=(B14-C14);
  if(document.getElementById('B15')) document.getElementById('B15').value=b15;
  if(document.getElementById('C15')) document.getElementById('C15').value=c15;
  ['A','B','C'].forEach(function(col){
    var el=document.getElementById(col+15);
    if(!el)return;
    var n=toNumber(el.value);
    el.classList.remove('positive','negative');
    if(!isNaN(n)){if(n<0)el.classList.add('negative');else if(n>0)el.classList.add('positive');}
  });
}
var editableIds=['B2','C2'];for(var r=3;r<=13;r++){editableIds.push('B'+r);editableIds.push('C'+r);}
editableIds.forEach(function(id){var el=document.getElementById(id);if(el)el.addEventListener('input',recalc);});
recalc();
</script>
</body>
</html>
